import numpy as np;q=open('input.txt').readlines();w,e,r,t,y=np.array([[l.split()for l in q[2+i*6:2+i*6+5]]for i in range(int((len(q)-1)/6))]).astype('int'),[int(n)for n in q[0].split(',')],[],-2,-1
while(p:=t)!=-1 and not r.append(e.pop(0)):
    y=sum((w[u][np.logical_not(np.isin(w[u],r))]).flatten())*r[-1]if(u:=s[0]if len(s:=(o:=np.logical_or(np.any(np.all(d:=np.isin(w,r),axis=1),axis=1),np.any(np.all(d,axis=2),axis=1))).nonzero()[0])>0 else-1)!=-1 and y==-1 else y
    if(t:=a[0]if len(a:=np.logical_not(o).nonzero()[0])>0 else-1)==-1:break
print(y,sum((w[p][np.logical_not(np.isin(w[p],r))]).flatten())*r[-1])
